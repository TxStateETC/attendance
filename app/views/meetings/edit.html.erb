<% content_for(:head) do %>
  <meta name="viewport" content="width=480, user-scalable=no">
<% end %>

<header>
  <%= link_to "< #{t('general.back')}", @meeting.section %>
  <h1 class="page_header"><%= @meeting.starttime.strftime('%B %-d, %Y at %l:%M%P') %></h1>
  <%# Button that will cancel/un-cancel a meeting %>
  <%= form_for(@meeting, html: {class: 'inline-form'}) do |f| %>
      <%= hidden_field(:meeting, :cancelled, {value: !@meeting.cancelled}) %>
      <%= f.submit (@meeting.cancelled ? t('meeting.reactivate_session') : t('meeting.cancel_session')), class: 'linkbutton' %>
  <% end %>
  <%# Button that will soft delete a meeting %>
  <%= form_for(@meeting, html: {class: 'inline-form'}) do |f| %>
      <%= hidden_field(:meeting, :deleted, {value: 'true'}) %>
      <%= f.submit t('meeting.delete_session'), class: 'linkbutton' %>
  <% end %>
</header>

<% if notice %>
    <p id="notice" class="no-margin-top"><%= notice %></p>
<% end %>

<div>
  <%= form_for(@meeting, html: {class: 'flex-item'}) do |f| %>
    <%= render 'errors' %>
    <%= render 'starttime' %>

    <p>
      Checkin code: <span id="checkin-code"><%= @meeting.checkin_code %></span>
      <button type="button" data-action="/meetings/<%= @meeting.id %>/code?remove=1" id="remove-code">Remove</button>
      <button type="button" data-action="/meetings/<%= @meeting.id %>/code" id="new-code">New</button>
    </p>
    <%= f.submit 'Save session', class: 'linkbutton' %>
  <% end %>

  <h3 class="section-header">Record attendance for this session</h3>
  <div><%= render 'record_attendance' %></div>
</div>
